{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/msokol/Projects/quizmaker/web/src/components/quizzes/quizzesContainer.js\";\nimport React, { Component, useState, useEffect } from 'react';\nimport { apiHost } from 'config';\nimport axios from 'axios';\nimport Quizzes from './quizzes';\nimport { isCompositeComponent } from 'react-dom/test-utils';\n\nclass QuizzesContainer extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      quizzes: [],\n      pageNumber: 0,\n      hasMore: false,\n      loading: true,\n      theTopic: \"\"\n    };\n\n    this.fetchQuizzesPaginated = async () => {\n      if (this.state.topic && this.state.topic.length > 1) return;\n      console.log(this.state.topic);\n      this.setState({\n        loading: true\n      });\n      const requests = [],\n            {\n        pageNumber\n      } = this.state,\n            size = 20;\n\n      for (let i = 0; i <= this.state.pageNumber; i++) requests.push(axios.get(`${apiHost}/api/quizzes`, {\n        params: {\n          page: pageNumber,\n          size: size\n        }\n      }));\n\n      const responses = await Promise.all(requests);\n      let data = [];\n      responses.forEach(response => data = [...data, ...response.data]);\n      const lastResponseLength = responses[responses.length - 1].data.length;\n      this.setState({\n        hasMore: lastResponseLength === size\n      });\n      this.setState({\n        loading: false,\n        quizzes: data\n      });\n    };\n\n    this.filterByTopic = topic => {\n      if (topic === \"\") {\n        this.reset();\n      } else {\n        this.setState({\n          theTopic: topic\n        });\n        this.fetchQuizzesByTopic(topic);\n      }\n    };\n  }\n\n  fetchQuizzesByTopic(topic) {\n    axios.get(`${apiHost}/api/quizzes`, {\n      params: {\n        topic\n      }\n    }).then(response => {\n      this.setState({\n        quizzes: response.data,\n        pageNumber: 0\n      });\n    });\n  }\n\n  componentDidMount() {\n    this.fetchQuizzesPaginated();\n  }\n\n  reset() {\n    this.setState({\n      quizzes: [],\n      pageNumber: 0,\n      hasMore: false,\n      loading: true\n    }, this.fetchQuizzesPaginated);\n  }\n\n  render() {\n    const {\n      quizzes,\n      hasMore,\n      loading\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"portal\",\n      children: /*#__PURE__*/_jsxDEV(Quizzes, {\n        quizzes: quizzes,\n        filterByTopic: this.filterByTopic,\n        hasMore: hasMore,\n        loading: loading,\n        incrementPageNumber: () => this.setState(prevState => {\n          return { ...prevState,\n            pageNumber: prevState.pageNumber + 1\n          };\n        }, this.fetchQuizzesPaginated)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default QuizzesContainer;","map":{"version":3,"sources":["/home/msokol/Projects/quizmaker/web/src/components/quizzes/quizzesContainer.js"],"names":["React","Component","useState","useEffect","apiHost","axios","Quizzes","isCompositeComponent","QuizzesContainer","state","quizzes","pageNumber","hasMore","loading","theTopic","fetchQuizzesPaginated","topic","length","console","log","setState","requests","size","i","push","get","params","page","responses","Promise","all","data","forEach","response","lastResponseLength","filterByTopic","reset","fetchQuizzesByTopic","then","componentDidMount","render","prevState"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect } from 'react';\nimport { apiHost } from 'config';\nimport axios from 'axios';\nimport Quizzes from './quizzes';\nimport { isCompositeComponent } from 'react-dom/test-utils';\n\nclass QuizzesContainer extends Component {\n\n    state = {\n        quizzes: [],\n        pageNumber: 0,\n        hasMore: false,\n        loading: true,\n        theTopic: \"\"\n    };\n\n    fetchQuizzesPaginated = async () => {\n        if(this.state.topic && this.state.topic.length > 1) return; \n\n        console.log(this.state.topic)\n\n        this.setState({loading: true});\n        const requests = [], { pageNumber } = this.state, size = 20;\n        \n        for (let i = 0; i <= this.state.pageNumber; i++) \n            requests.push(axios.get(`${apiHost}/api/quizzes`, {\n                params: {\n                    page: pageNumber,\n                    size: size\n                }\n            }))\n        \n        const responses = await Promise.all(requests);\n        let data = [];\n        responses.forEach(response => data = [...data, ...response.data])\n\n        const lastResponseLength = responses[responses.length-1].data.length;\n        this.setState({hasMore: lastResponseLength === size});\n    \n        this.setState({loading: false, quizzes: data})\n    }\n\n    fetchQuizzesByTopic(topic) {\n        axios.get(`${apiHost}/api/quizzes`, {\n            params: { topic }\n        }).then(response => {\n            this.setState({\n                quizzes: response.data,\n                pageNumber: 0\n            })\n        })\n    }\n\n    componentDidMount() {\n        this.fetchQuizzesPaginated();\n    }\n\n    reset() {\n        this.setState({\n            quizzes: [],\n            pageNumber: 0,\n            hasMore: false,\n            loading: true\n        }, this.fetchQuizzesPaginated)\n    }\n\n    filterByTopic = topic => {\n        if(topic === \"\") {\n            this.reset();\n        } else {\n            this.setState({theTopic: topic})\n            this.fetchQuizzesByTopic(topic)\n        }\n    }\n\n    render() {\n\n        const { quizzes, hasMore, loading } = this.state;\n\n        return(\n            <div className=\"portal\">\n                <Quizzes \n                    quizzes={quizzes} \n                    filterByTopic={this.filterByTopic}\n                    hasMore={hasMore} \n                    loading={loading}\n\n                    incrementPageNumber={() => this.setState(prevState => {\n                        return {\n                            ...prevState,   \n                            pageNumber: prevState.pageNumber + 1\n                        }\n                    }, this.fetchQuizzesPaginated)}\n                 />\n            </div>\n        )\n    }\n\n\n}\n \nexport default QuizzesContainer;"]},"metadata":{},"sourceType":"module"}